'From Squeak4.5 of 19 February 2014 [latest update: #13680] on 19 March 2015 at 5:55:02 am'!PegCollection subclass: #ButtonBoard	instanceVariableNames: 'callback indCreated indicator selectedColor'	classVariableNames: ''	poolDictionaries: ''	category: 'Mastermind'!!ButtonBoard methodsFor: 'accessing' stamp: 'OJMS 3/18/2015 21:33'!addIndicator: peg	"Add an indicator to the array of all indicator pegs"	indCreated := indCreated + 1.	indicator at: ((total + 1) - indCreated) put: peg.	"total + 1 aligns this to a 1-based array, and the (total + 1) - created	prevents the ordering of the pegs in the array from appearing in	reverse order when on display"! !!ButtonBoard methodsFor: 'accessing' stamp: 'OJMS 3/18/2015 22:35'!getSelectedColor	"Get the color of the selected thingy"	^selectedColor.! !!ButtonBoard methodsFor: 'accessing' stamp: 'OJMS 3/18/2015 22:35'!setSelectedColor: clr	"Set the color of the selected thingy"	selectedColor := clr.! !!ButtonBoard methodsFor: 'initialization' stamp: 'OJMS 3/18/2015 21:31'!initIndArray	"Create the array to hold all of the indicator pegs"	indicator := Array new: total.! !!ButtonBoard methodsFor: 'initialization' stamp: 'OJMS 3/18/2015 21:32'!initIndCreated	"Set the total number of indicator pegs to 0"	indCreated := 0.! !!ButtonBoard methodsFor: 'event handling' stamp: 'OJMS 3/18/2015 23:23'!action: cbk	"Set the BlockContext ButtonBoard will call when it is clicked"	callback := cbk.! !!ButtonBoard methodsFor: 'event handling' stamp: 'OJMS 3/19/2015 05:07'!pegClicked: peg	| colorMgr |	"Change indicator for the selected peg"	1 to: total do: [ :i | | ind |		ind := indicator at: i.		ind setColor: 3.		( ind getPegNumber == peg getPegNumber )			ifTrue: [				ind setColor: 1.			].				ind changed.	].	"Change the internal color indicator"	colorMgr := PlayerColors new.	self setSelectedColor: ( colorMgr getColorIndex: ( peg color ) ).	"Trigger the callback"	callback value.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!ButtonBoard class	instanceVariableNames: ''!!ButtonBoard class methodsFor: 'initialize-release' stamp: 'OJMS 3/18/2015 22:56'!new	| instance |	"Create enough room for the button board"	instance := super new: 6.	instance cellInset: 5.	instance layoutInset: 5.	instance listDirection: #topToBottom.	instance unlock.	"Initialize memory for the indicator pegs"	instance initIndCreated.	instance initIndArray.		1 to: 6 do: [ :i | | indicator peg row |		"Create a row to put a peg and an indicator"		row := RectangleMorph new.		row cellInset: 5.		row hResizing: #shrinkWrap.		row layoutPolicy: TableLayout new.		row listDirection: #leftToRight.		row vResizing: #shrinkWrap.		"Hide yo kids, hide yo wife"		row borderWidth: 0.		row color: Color transparent.				"Create the peg the user will click on"		peg := BigPeg new.		peg setColor: 7 - i.		peg setPegNumber: i.		peg action: [			instance pegClicked: peg.		].				"Create an indicator"		indicator := SmallPeg new.		indicator setColor: 3.		indicator setPegNumber: i.		( i == 6 )			ifTrue: [ | colorMgr |				colorMgr := AnswerColors new.				indicator setColor: 1.				instance setSelectedColor: ( colorMgr getColorIndex: ( indicator color ) )..			].		"Add stuff in"		row addMorph: indicator.		row addMorph: peg.		instance addIndicator: indicator.		instance addPeg: peg..		instance addMorph: row.	].		^instance.! !